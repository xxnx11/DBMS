mysql> CREATE DATABASE college_db;

mysql> USE college_db;

mysql> CREATE TABLE student (
   student_id INT PRIMARY KEY,
   name VARCHAR(50),
   major VARCHAR(50),
   cgpa DECIMAL(3,2)
   );

mysql> CREATE TABLE enrollment (
      enrollment_id INT PRIMARY KEY,
      student_id INT,
      course VARCHAR(100),
      grade VARCHAR(5),
      credits INT
      );

mysql> INSERT INTO student (student_id, name, major, cgpa) VALUES
     (1, 'Alice', 'Computer Science', 3.8),
     (2, 'Bob', 'Mathematics', 3.2),
     (3, 'Carol', 'Physics', 3.9),
     (4, 'David', 'Computer Science', 3.5),
     (5, 'Emma', 'Mathematics', 3.7);

mysql> INSERT INTO enrollment (enrollment_id, student_id, course, grade, credits) VALUES
     (101, 1, 'Database', 'A', 3),
     (102, 1, 'Programming', 'B+', 4),
     (103, 2, 'Calculus', 'A-', 4),
     (104, 3, 'Quantum Physics', 'A', 3),
     (105, 4, 'Data Structures', 'B', 3),
     (106, 5, 'Statistics', 'A', 3),
     (107, 2, 'Algebra', 'B+', 3);

mysql> SELECT s.name, e.enrollment_id, e.course, e.grade
     FROM student s
     INNER JOIN enrollment e ON s.student_id = e.student_id;

mysql> SELECT s.name, e.enrollment_id, e.course, e.grade
     FROM student s
     LEFT JOIN enrollment e ON s.student_id = e.student_id;

mysql> SELECT s.name, e.enrollment_id, e.course, e.grade
     FROM student s
     RIGHT JOIN enrollment e ON s.student_id = e.student_id;

mysql> SELECT s.student_id, s.name, e.enrollment_id, e.course, e.grade
     FROM student s
     LEFT JOIN enrollment e ON s.student_id = e.student_id
     UNION
     SELECT s.student_id, s.name, e.enrollment_id, e.course, e.grade
     FROM student s
     RIGHT JOIN enrollment e ON s.student_id = e.student_id;

mysql> SELECT
     s.name,
     s.major,
     SUM(e.credits) AS total_credits,
     ROUND(AVG(
     CASE e.grade
     WHEN 'A' THEN 4.0
     WHEN 'A-' THEN 3.7
     WHEN 'B+' THEN 3.3
     WHEN 'B' THEN 3.0
     ELSE NULL
     END
     ), 2) AS avg_gpa
    FROM student s
     LEFT JOIN enrollment e ON s.student_id = e.student_id
     GROUP BY s.student_id, s.name,s.major;

mysql> SELECT * FROM student
     WHERE cgpa > (
     SELECT cgpa FROM student WHERE name = 'Bob'
     );

mysql> SELECT course FROM enrollment
       WHERE student_id IN (
       SELECT student_id FROM student WHERE major = 'Computer Science'
       );

mysql> SELECT * FROM enrollment
    WHERE student_id = (
    SELECT student_id FROM student
    WHERE cgpa = (SELECT MAX(cgpa) FROM student)
     );

mysql> SELECT * FROM student
     WHERE student_id IN (
     SELECT student_id FROM enrollment
     GROUP BY student_id
     HAVING COUNT(*) > 1
     );

mysql> SELECT * FROM student s
      WHERE EXISTS (
      SELECT 1 FROM enrollment e
      WHERE e.student_id = s.student_id
     );

mysql> SELECT * FROM student s
     WHERE NOT EXISTS (
     SELECT 1 FROM enrollment e
     WHERE e.student_id = s.student_id
     );

mysql> SELECT name,
     (SELECT COUNT(*) FROM enrollment e WHERE e.student_id = s.student_id) AS course_count
     FROM student s;

mysql> SELECT * FROM student s
     WHERE cgpa > (
     SELECT AVG(cgpa) FROM student
     WHERE major = s.major
     );

mysql> SELECT * FROM student s
     WHERE (
     SELECT SUM(credits) FROM enrollment e WHERE e.student_id = s.student_id
     ) > (
     SELECT AVG(total_credits) FROM (
     SELECT student_id, SUM(credits) AS total_credits
     FROM enrollment
     GROUP BY student_id
     ) AS credit_totals
     );

mysql> SELECT * FROM student
     WHERE major = 'Computer Science'
     AND cgpa > (
     SELECT AVG(cgpa) FROM student
     );
